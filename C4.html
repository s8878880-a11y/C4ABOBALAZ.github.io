<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Симулятор C4 для лазертага</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #000;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            touch-action: manipulation;
        }
        
        .container {
            position: relative;
            width: 100%;
            max-width: 450px;
            height: 800px;
        }
        
        .c4-body {
            position: absolute;
            width: 95%;
            height: 90%;
            top: 5%;
            left: 2.5%;
            background: linear-gradient(135deg, #556b2f 0%, #6b8e23 100%);
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(107, 142, 35, 0.6);
            z-index: 1;
            border: 3px solid #3a4a1f;
        }
        
        .screen {
            position: absolute;
            top: 10%;
            left: 50%;
            transform: translateX(-50%);
            width: 85%;
            height: 15%;
            background-color: #d0f0c0;
            border: 4px solid #4a5d23;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
            font-size: 3rem;
            color: #000;
            text-align: center;
            padding: 10px;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.4);
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        }
        
        .keypad {
            position: absolute;
            bottom: 12%;
            left: 50%;
            transform: translateX(-50%);
            width: 85%;
            height: 50%;
            background-color: #4a5d23;
            border-radius: 12px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 12px;
            padding: 20px;
            box-sizing: border-box;
            z-index: 20;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.8);
            border: 3px solid #3a4a1f;
        }
        
        .key {
            background: linear-gradient(145deg, #808080, #a0a0a0);
            border: none;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.2rem;
            font-weight: bold;
            color: #fff;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.7),
                        0 4px 8px rgba(0, 0, 0, 0.3);
            user-select: none;
            -webkit-user-select: none;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .key:active {
            background: linear-gradient(145deg, #909090, #b0b0b0);
            transform: scale(0.96);
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .key::before {
            content: "";
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(45deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0) 50%);
            transform: rotate(45deg);
        }
        
        .red-button {
            position: absolute;
            top: 5%;
            left: 10%;
            width: 60px;
            height: 60px;
            background: radial-gradient(circle at 30% 30%, #ff0000, #cc0000);
            border-radius: 50%;
            border: 4px solid #800000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.7),
                        inset 0 0 10px rgba(255, 255, 255, 0.2);
            z-index: 20;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 0.9rem;
            text-align: center;
            user-select: none;
            -webkit-user-select: none;
            text-shadow: 0 0 3px rgba(0, 0, 0, 0.5);
        }
        
        .red-button:active {
            background: radial-gradient(circle at 30% 30%, #cc0000, #aa0000);
            transform: scale(0.95);
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.5),
                        inset 0 0 15px rgba(0, 0, 0, 0.3);
        }
        
        .explosion {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, #ff6600, #ff0000, #990000);
            opacity: 0;
            z-index: 100;
            transition: opacity 0.5s, transform 0.5s;
            transform: translate(-50%, -50%) scale(0);
            border-radius: 50%;
            pointer-events: none;
        }
        
        .explosion.active {
            opacity: 0.9;
            transform: translate(-50%, -50%) scale(15);
        }
        
        .defuse-progress {
            position: absolute;
            bottom: 5%;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 12px;
            background-color: #3a4a1f;
            border-radius: 6px;
            overflow: hidden;
            z-index: 20;
            display: none;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
        }
        
        .defuse-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #00aa00, #00ff00);
            transition: width 0.1s linear;
            box-shadow: 0 0 5px rgba(0, 255, 0, 0.7);
        }
        
        .led {
            position: absolute;
            top: 5%;
            right: 10%;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #ff0000, #cc0000);
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
            z-index: 20;
        }
        
        .led.active {
            background: radial-gradient(circle at 30% 30%, #00ff00, #00aa00);
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.7);
        }
        
        .wires {
            position: absolute;
            top: 30%;
            width: 100%;
            height: 20%;
            z-index: 15;
        }
        
        .wire {
            position: absolute;
            height: 4px;
            background-color: #ccc;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }
        
        .wire-1 {
            top: 20%;
            left: 15%;
            width: 20%;
            background: linear-gradient(90deg, #ff0, #cc0);
        }
        
        .wire-2 {
            top: 40%;
            right: 15%;
            width: 20%;
            background: linear-gradient(90deg, #00f, #008);
        }
        
        .wire-3 {
            top: 60%;
            left: 20%;
            width: 15%;
            background: linear-gradient(90deg, #f00, #800);
        }
        
        .code-hint {
            position: absolute;
            top: 28%;
            left: 50%;
            transform: translateX(-50%);
            color: #d0f0c0;
            font-size: 1rem;
            text-align: center;
            z-index: 20;
            text-shadow: 0 0 3px rgba(0, 0, 0, 0.8);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="c4-body"></div>
        
        <div class="red-button" id="redButton">ОБЕЗВРЕДИТЬ</div>
        <div class="led" id="led"></div>
        
        <div class="screen" id="screen">ВВОД КОДА</div>
        <div class="code-hint">КОД: 583458</div>
        
        <div class="wires">
            <div class="wire wire-1"></div>
            <div class="wire wire-2"></div>
            <div class="wire wire-3"></div>
        </div>
        
        <div class="keypad">
            <button class="key" data-value="1">1</button>
            <button class="key" data-value="2">2</button>
            <button class="key" data-value="3">3</button>
            <button class="key" data-value="4">4</button>
            <button class="key" data-value="5">5</button>
            <button class="key" data-value="6">6</button>
            <button class="key" data-value="7">7</button>
            <button class="key" data-value="8">8</button>
            <button class="key" data-value="9">9</button>
            <button class="key" data-value="*">*</button>
            <button class="key" data-value="0">0</button>
            <button class="key" data-value="#">#</button>
        </div>
        
        <div class="defuse-progress" id="defuseProgress">
            <div class="defuse-bar" id="defuseBar"></div>
        </div>
        
        <div class="explosion" id="explosion"></div>
    </div>

    <script>
        const screen = document.getElementById('screen');
        const explosion = document.getElementById('explosion');
        const keys = document.querySelectorAll('.key');
        const redButton = document.getElementById('redButton');
        const defuseProgress = document.getElementById('defuseProgress');
        const defuseBar = document.getElementById('defuseBar');
        const led = document.getElementById('led');
        
        const correctCode = '583458';
        let enteredCode = '';
        let timer = null;
        let timeLeft = 90;
        let defuseTimer = null;
        let isDefusing = false;
        let isActive = false;
        
        // Обработчики для кнопок клавиатуры
        keys.forEach(key => {
            key.addEventListener('click', () => {
                const value = key.getAttribute('data-value');
                
                if (value === '*') {
                    // Сброс
                    resetBomb();
                } else if (!isActive && enteredCode.length < 6) {
                    enteredCode += value;
                    screen.textContent = enteredCode.split('').map(() => '•').join('');
                    
                    // Автопроверка кода при вводе 6 цифр
                    if (enteredCode.length === 6) {
                        if (enteredCode === correctCode) {
                            isActive = true;
                            startTimer();
                        } else {
                            screen.textContent = 'ОШИБКА';
                            setTimeout(() => {
                                screen.textContent = 'ВВОД КОДА';
                                enteredCode = '';
                            }, 1000);
                        }
                    }
                }
            });
        });
        
        // Обработчики для красной кнопки (обезвреживание)
        redButton.addEventListener('mousedown', startDefuse);
        redButton.addEventListener('touchstart', startDefuse);
        
        redButton.addEventListener('mouseup', stopDefuse);
        redButton.addEventListener('mouseleave', stopDefuse);
        redButton.addEventListener('touchend', stopDefuse);
        
        function startTimer() {
            led.classList.remove('active');
            timeLeft = 90;
            screen.textContent = formatTime(timeLeft);
            screen.style.color = '#000';
            screen.style.fontWeight = 'bold';
            
            timer = setInterval(() => {
                timeLeft--;
                screen.textContent = formatTime(timeLeft);
                
                if (timeLeft <= 10) {
                    screen.style.color = '#ff0000';
                    screen.style.textShadow = '0 0 10px rgba(255, 0, 0, 0.7)';
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    explode();
                }
            }, 1000);
        }
        
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }
        
        function startDefuse() {
            if (!isActive) return;
            
            isDefusing = true;
            defuseProgress.style.display = 'block';
            defuseBar.style.width = '0%';
            
            let progress = 0;
            defuseTimer = setInterval(() => {
                progress += 2;
                defuseBar.style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(defuseTimer);
                    defuseBomb();
                }
            }, 100);
        }
        
        function stopDefuse() {
            if (!isDefusing) return;
            
            clearInterval(defuseTimer);
            defuseProgress.style.display = 'none';
            isDefusing = false;
        }
        
        function defuseBomb() {
            clearInterval(timer);
            timer = null;
            isActive = false;
            led.classList.add('active');
            screen.textContent = 'ОБЕЗВРЕЖЕНО';
            screen.style.color = '#00aa00';
            screen.style.textShadow = '0 0 10px rgba(0, 255, 0, 0.7)';
            defuseProgress.style.display = 'none';
            isDefusing = false;
            
            setTimeout(() => {
                resetBomb();
            }, 3000);
        }
        
        function resetBomb() {
            clearInterval(timer);
            timer = null;
            isActive = false;
            enteredCode = '';
            screen.textContent = 'ВВОД КОДА';
            screen.style.color = '#000';
            screen.style.fontWeight = 'normal';
            screen.style.textShadow = '0 0 5px rgba(0, 0, 0, 0.3)';
            led.classList.remove('active');
            defuseProgress.style.display = 'none';
            isDefusing = false;
        }
        
        function explode() {
            explosion.classList.add('active');
            screen.textContent = 'БУМ!';
            screen.style.color = '#ff0000';
            screen.style.textShadow = '0 0 15px rgba(255, 0, 0, 0.9)';
            
            setTimeout(() => {
                explosion.classList.remove('active');
                resetBomb();
            }, 2000);
        }
    </script>
</body>
</html>
